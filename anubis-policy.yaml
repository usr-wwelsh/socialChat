bots:
  # Allow static preview assets without challenge (OG images, favicon, etc.)
  # Needed because Meta's bot also fetches the og:image URL and would get blocked
  - name: preview-assets
    path_regex: >-
      \.(png|jpg|jpeg|gif|svg|ico|webp)$
    action: ALLOW

  # Allow social media preview bots (link embeds) by user agent
  - name: social-preview-bots
    user_agent_regex: >-
      Discordbot|Twitterbot|TelegramBot|Slackbot|LinkedInBot|WhatsApp|Pinterestbot|Redditbot|facebookexternalhit|Facebot|FacebookBot|meta-externalagent|Meta-ExternalAgent|meta-externalfetcher|Meta-ExternalFetcher|MetaInspector
    action: ALLOW

  # Default Anubis rules
  - import: (data)/bots/_deny-pathological.yaml
  - import: (data)/meta/ai-block-aggressive.yaml
  - import: (data)/crawlers/_allow-good.yaml
  - import: (data)/clients/x-firefox-ai.yaml
  - import: (data)/common/keep-internet-working.yaml

  - name: generic-browser
    user_agent_regex: >-
      Mozilla|Opera
    action: WEIGH
    weight:
      adjust: 10

dnsbl: false

openGraph:
  enabled: true
  considerHost: true
  ttl: 24h

status_codes:
  CHALLENGE: 200
  DENY: 200

store:
  backend: memory
  parameters: {}

thresholds:
  - name: minimal-suspicion
    expression: weight <= 0
    action: ALLOW
  - name: mild-suspicion
    expression:
      all:
        - weight > 0
        - weight < 10
    action: CHALLENGE
    challenge:
      algorithm: fast
      difficulty: 4
  - name: normal-browser
    expression:
      all:
        - weight >= 10
        - weight < 20
    action: CHALLENGE
    challenge:
      algorithm: fast
      difficulty: 5
  - name: suspicious
    expression:
      all:
        - weight >= 20
        - weight < 30
    action: CHALLENGE
    challenge:
      algorithm: fast
      difficulty: 6
  - name: extreme-suspicion
    expression: weight >= 30
    action: CHALLENGE
    challenge:
      algorithm: fast
      difficulty: 8
