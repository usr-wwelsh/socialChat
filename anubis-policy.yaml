bots:
  # Allow social media preview bots (link embeds) BEFORE deny rules
  - name: social-preview-bots
    user_agent_regex: >-
      Discordbot|Twitterbot|TelegramBot|Slackbot|LinkedInBot|WhatsApp|Pinterestbot|Redditbot|facebookexternalhit|Facebot|MetaInspector
    action: ALLOW

  # Default Anubis rules
  - import: (data)/bots/_deny-pathological.yaml
  - import: (data)/meta/ai-block-aggressive.yaml
  - import: (data)/crawlers/_allow-good.yaml
  - import: (data)/clients/x-firefox-ai.yaml
  - import: (data)/common/keep-internet-working.yaml

  - name: generic-browser
    user_agent_regex: >-
      Mozilla|Opera
    action: WEIGH
    weight:
      adjust: 10

dnsbl: false

openGraph:
  enabled: true
  considerHost: true
  ttl: 24h

status_codes:
  CHALLENGE: 200
  DENY: 200

store:
  backend: memory
  parameters: {}

thresholds:
  - name: minimal-suspicion
    expression: weight <= 0
    action: ALLOW
  - name: mild-suspicion
    expression:
      all:
        - weight > 0
        - weight < 10
    action: CHALLENGE
    challenge:
      algorithm: metarefresh
      difficulty: 1
  - name: moderate-suspicion
    expression:
      all:
        - weight >= 10
        - weight < 20
    action: CHALLENGE
    challenge:
      algorithm: fast
      difficulty: 2
  - name: mild-proof-of-work
    expression:
      all:
        - weight >= 20
        - weight < 30
    action: CHALLENGE
    challenge:
      algorithm: fast
      difficulty: 4
  - name: extreme-suspicion
    expression: weight >= 30
    action: CHALLENGE
    challenge:
      algorithm: fast
      difficulty: 6
